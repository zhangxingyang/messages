import{p as t,g as e,s,o as a,c as l,w as n,a as i,b as o,t as r,d as u,r as d,F as c,I as g,i as f,e as h,f as m,n as p,h as _}from"./index.8f2e5625.js";var y=((t,e)=>{const s=t.__vccOpts||t;for(const[a,l]of e)s[a]=l;return s})({data(){return{content:"",list:this.getList(),status:"正在加载留言",mode:"getMessages",timer:null}},onLoad(){this.timer=setInterval((()=>this.getList(this.mode)),2500)},onUnload(){clearInterval(this.timer)},methods:{getList(s){t.callFunction({name:"fun",data:{api:s||"getMessages",token:e("token")}}).then((t=>{this.list=t.result.data,this.status=0==this.list?"留言板是空的":"所有留言内容"}))},publish(){if(this.mode="getMessages",!this.content.trim())return s({title:"留言无效",icon:"error"}),void(this.status="留言无效");t.callFunction({name:"fun",data:{api:"publish",content:this.content}}).then((t=>{if(!1===t.result.success)return console.log(t.result.errMsg),s({icon:"error",title:t.result.errMsg}),this.content="",void(this.status="留言失败");this.status="留言成功",s({title:"留言成功",icon:"success"}),this.content=""}))},changeMode(){"getMessages"!==this.mode?"getMyMessages"!==this.mode||(this.mode="getMessages"):this.mode="getMyMessages"}}},[["render",function(t,e,s,y,M,b){const k=g,x=f,v=h,L=m;return a(),l(L,null,{default:n((()=>[i(L,{class:"inputArea"},{default:n((()=>[i(k,{type:"text",class:"input",modelValue:M.content,"onUpdate:modelValue":e[0]||(e[0]=t=>M.content=t),placeholder:"在这里写上你的留言"},null,8,["modelValue"]),i(x,{type:"primary",onClick:e[1]||(e[1]=t=>b.publish()),size:"mini",style:{"margin-left":"5rpx"}},{default:n((()=>[o("发布")])),_:1}),i(x,{type:"primary",onClick:e[2]||(e[2]=t=>{b.changeMode(),b.getList(M.mode)}),size:"mini",style:{"margin-left":"5rpx","padding-left":"15rpx","padding-right":"15rpx"}},{default:n((()=>[i(v,null,{default:n((()=>[o("所有留言")])),_:1})])),_:1})])),_:1}),i(L,{class:"status"},{default:n((()=>[i(v,null,{default:n((()=>[o(r(M.status),1)])),_:1})])),_:1}),i(L,{class:"message"},{default:n((()=>[(a(!0),u(c,null,d(M.list,(t=>(a(),l(L,{key:t._id},{default:n((()=>[i(L,{class:"box",style:p({background:t.backgroundColor})},{default:n((()=>[i(L,null,{default:n((()=>[i(L,{style:{"font-size":"1.3rem","word-break":"break-all"}},{default:n((()=>[o(r(t.content),1)])),_:2},1024),i(L,{style:{"font-size":"1rem"}},{default:n((()=>[o(r(t.time),1)])),_:2},1024)])),_:2},1024),t.public?_("",!0):(a(),l(L,{key:0,style:{color:"#224e5b",margin:"30rpx"}},{default:n((()=>[o("未公开")])),_:1}))])),_:2},1032,["style"])])),_:2},1024)))),128))])),_:1})])),_:1})}],["__scopeId","data-v-009175ef"]]);export{y as default};
